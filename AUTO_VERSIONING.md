# ğŸ¤– ç®€åŒ–è‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ

æœ¬é¡¹ç›®å®ç°äº†ç®€å•é«˜æ•ˆçš„è‡ªåŠ¨å‘å¸ƒæµç¨‹ï¼ŒåŸºäºç‰ˆæœ¬å·æ¯”è¾ƒè‡ªåŠ¨å‘å¸ƒåˆ° NPMã€‚

## ğŸš€ å·¥ä½œåŸç†

### ç®€å•ç‰ˆæœ¬æ£€æµ‹

ç³»ç»Ÿåªåšä¸€ä»¶äº‹ï¼š**æ¯”è¾ƒ package.json ä¸­çš„ç‰ˆæœ¬ä¸ NPM ä¸Šå·²å‘å¸ƒçš„ç‰ˆæœ¬**

- âœ… **ç‰ˆæœ¬ä¸ä¸€è‡´** â†’ è‡ªåŠ¨å‘å¸ƒæ–°ç‰ˆæœ¬
- âŒ **ç‰ˆæœ¬ä¸€è‡´** â†’ è·³è¿‡å‘å¸ƒ

### ç‰ˆæœ¬ç®¡ç†æ–¹å¼

**æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·**ï¼š
```bash
# ä½ éœ€è¦æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬
npm version patch   # 1.0.0 â†’ 1.0.1
npm version minor   # 1.0.0 â†’ 1.1.0  
npm version major   # 1.0.0 â†’ 2.0.0
```

## ğŸ“‹ è‡ªåŠ¨åŒ–æµç¨‹

### è§¦å‘æ¡ä»¶

âœ… **è‡ªåŠ¨å‘å¸ƒ**ï¼š
- æ¨é€åˆ° `main` åˆ†æ”¯
- æ‰€æœ‰æµ‹è¯•é€šè¿‡
- package.json ç‰ˆæœ¬ä¸ NPM ç‰ˆæœ¬ä¸ä¸€è‡´

âŒ **è·³è¿‡å‘å¸ƒ**ï¼š
- æµ‹è¯•å¤±è´¥
- package.json ç‰ˆæœ¬ä¸ NPM ç‰ˆæœ¬ä¸€è‡´

### ç®€åŒ–æµç¨‹

```mermaid
graph TD
    A[æ¨é€åˆ° main åˆ†æ”¯] --> B[è¿è¡Œæµ‹è¯•å¥—ä»¶]
    B --> C{æµ‹è¯•æ˜¯å¦é€šè¿‡?}
    C -->|å¦| D[åœæ­¢æµç¨‹]
    C -->|æ˜¯| E[æ¯”è¾ƒç‰ˆæœ¬å·]
    E --> F{ç‰ˆæœ¬æ˜¯å¦ä¸åŒ?}
    F -->|å¦| G[è·³è¿‡å‘å¸ƒ]
    F -->|æ˜¯| H[åˆ›å»º Git æ ‡ç­¾]
    H --> I[å‘å¸ƒåˆ° NPM]
    I --> J[åˆ›å»º GitHub Release]
```

## ğŸ› ï¸ é…ç½®è¦æ±‚

### å¿…éœ€çš„ GitHub Secrets

åœ¨ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ secretsï¼š

```
NPM_TOKEN=npm_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### è·å– NPM Token

1. **ç½‘é¡µæ–¹å¼**ï¼ˆæ¨èï¼‰ï¼š
   - è®¿é—® https://www.npmjs.com/settings/tokens
   - ç‚¹å‡» "Generate New Token" â†’ "Classic Token"
   - é€‰æ‹© "Automation" ç±»å‹
   - å¤åˆ¶ç”Ÿæˆçš„ token

2. **å‘½ä»¤è¡Œæ–¹å¼**ï¼š
   ```bash
   npm login
   npm token create --access=public
   ```

## ğŸ“ ç‰ˆæœ¬æ›´æ–°æµç¨‹

ç®€å•çš„ä¸‰æ­¥å‘å¸ƒæµç¨‹ï¼š

### 1ï¸âƒ£ æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·
```bash
# æ ¹æ®ä½ çš„æ›´æ”¹ç±»å‹é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬æ›´æ–°
npm version patch   # ä¿®å¤ bug: 1.0.0 â†’ 1.0.1
npm version minor   # æ–°åŠŸèƒ½: 1.0.0 â†’ 1.1.0
npm version major   # ç ´åæ€§æ›´æ”¹: 1.0.0 â†’ 2.0.0
```

### 2ï¸âƒ£ æäº¤å¹¶æ¨é€
```bash
git add .
git commit -m "ä½ çš„æäº¤ä¿¡æ¯"  # æäº¤ä¿¡æ¯å¯ä»¥éšæ„å†™
git push origin main
```

### 3ï¸âƒ£ è‡ªåŠ¨å‘å¸ƒ
- GitHub Actions è‡ªåŠ¨æ£€æµ‹ç‰ˆæœ¬å˜åŒ–
- è¿è¡Œæ‰€æœ‰æµ‹è¯•
- å‘å¸ƒåˆ° NPM
- åˆ›å»º GitHub Release

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1ï¼šä¿®å¤ Bug

```bash
# 1. ä¿®å¤ä»£ç åï¼Œæ›´æ–°ç‰ˆæœ¬
npm version patch  # 1.2.3 â†’ 1.2.4

# 2. æäº¤å¹¶æ¨é€
git add .
git commit -m "fix: resolve markdown parsing issue"
git push origin main

# 3. è‡ªåŠ¨ç»“æœï¼š
# âœ… æ£€æµ‹åˆ°ç‰ˆæœ¬å˜åŒ– 1.2.3 â†’ 1.2.4
# âœ… å‘å¸ƒåˆ° NPM
# âœ… åˆ›å»º GitHub Release
```

### åœºæ™¯ 2ï¼šæ·»åŠ æ–°åŠŸèƒ½

```bash
# 1. å¼€å‘æ–°åŠŸèƒ½åï¼Œæ›´æ–°ç‰ˆæœ¬
npm version minor  # 1.2.4 â†’ 1.3.0

# 2. æäº¤å¹¶æ¨é€
git add .
git commit -m "feat: add support for custom containers"
git push origin main

# 3. è‡ªåŠ¨ç»“æœï¼š
# âœ… æ£€æµ‹åˆ°ç‰ˆæœ¬å˜åŒ– 1.2.4 â†’ 1.3.0
# âœ… å‘å¸ƒåˆ° NPM
# âœ… åˆ›å»º GitHub Release
```

### åœºæ™¯ 3ï¼šç ´åæ€§æ›´æ”¹

```bash
# 1. é‡å¤§æ›´æ”¹åï¼Œæ›´æ–°ç‰ˆæœ¬
npm version major  # 1.3.0 â†’ 2.0.0

# 2. æäº¤å¹¶æ¨é€
git add .
git commit -m "breaking: redesign plugin configuration API"
git push origin main

# 3. è‡ªåŠ¨ç»“æœï¼š
# âœ… æ£€æµ‹åˆ°ç‰ˆæœ¬å˜åŒ– 1.3.0 â†’ 2.0.0
# âœ… å‘å¸ƒåˆ° NPM
# âœ… åˆ›å»º GitHub Release
```

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### æŸ¥çœ‹è‡ªåŠ¨åŒ–çŠ¶æ€

1. **GitHub Actions**ï¼š
   - è®¿é—®ä»“åº“çš„ "Actions" æ ‡ç­¾
   - æŸ¥çœ‹æœ€æ–°çš„ "CI/CD Pipeline" è¿è¡ŒçŠ¶æ€

2. **ç‰ˆæœ¬å†å²**ï¼š
   - æŸ¥çœ‹ `package.json` ä¸­çš„ç‰ˆæœ¬å·
   - æ£€æŸ¥ Git æ ‡ç­¾ï¼š`git tag -l`
   - æŸ¥çœ‹ NPM å‘å¸ƒå†å²

### å¸¸è§é—®é¢˜æ’æŸ¥

#### âŒ NPM å‘å¸ƒå¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- NPM_TOKEN è¿‡æœŸæˆ–æ— æ•ˆ
- ç½‘ç»œè¿æ¥é—®é¢˜
- åŒ…åå†²çª

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ token æœ‰æ•ˆæ€§
npm whoami --registry https://registry.npmjs.org/

# é‡æ–°ç”Ÿæˆ token
npm token create --access=public
```

#### âŒ ç‰ˆæœ¬æ£€æµ‹é”™è¯¯

**å¯èƒ½åŸå› **ï¼š
- Git å†å²ä¸å®Œæ•´
- æ ‡ç­¾ä¿¡æ¯ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ‰‹åŠ¨åˆ›å»ºåˆå§‹æ ‡ç­¾
git tag v1.0.0
git push origin v1.0.0
```

#### âŒ æƒé™é—®é¢˜

**å¯èƒ½åŸå› **ï¼š
- GitHub token æƒé™ä¸è¶³
- åˆ†æ”¯ä¿æŠ¤è§„åˆ™å†²çª

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ GITHUB_TOKEN æœ‰å†™å…¥æƒé™
- æ£€æŸ¥åˆ†æ”¯ä¿æŠ¤è®¾ç½®

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰ç‰ˆæœ¬è§„åˆ™

å¯ä»¥ä¿®æ”¹ `.github/workflows/ci.yml` ä¸­çš„ç‰ˆæœ¬æ£€æµ‹é€»è¾‘ï¼š

```bash
# æ·»åŠ æ›´å¤šå…³é”®è¯
if echo "$COMMIT_MESSAGES" | grep -i "breaking\|major\|BREAKING" > /dev/null; then
  VERSION_TYPE="major"
elif echo "$COMMIT_MESSAGES" | grep -i "feat\|feature\|minor\|add" > /dev/null; then
  VERSION_TYPE="minor"
fi
```

### æ¡ä»¶å‘å¸ƒ

```yaml
# åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹å‘å¸ƒ
- name: Publish to npm
  if: |
    steps.version-check.outputs.should-publish == 'true' &&
    !contains(github.event.head_commit.message, '[no-publish]')
```

## ğŸ“Š æ•ˆæœå±•ç¤º

å¯ç”¨è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†åï¼Œä½ çš„å¼€å‘æµç¨‹å°†å˜æˆï¼š

1. **å¼€å‘** â†’ å†™ä»£ç 
2. **æäº¤** â†’ `git commit -m "feat: new feature"`
3. **æ¨é€** â†’ `git push origin main`
4. **ç­‰å¾…** â†’ GitHub Actions è‡ªåŠ¨å¤„ç†ä¸€åˆ‡
5. **å®Œæˆ** â†’ æ–°ç‰ˆæœ¬å·²å‘å¸ƒåˆ° NPM ğŸ‰

**æ— éœ€æ‰‹åŠ¨**ï¼š
- âŒ æ›´æ–°ç‰ˆæœ¬å·
- âŒ åˆ›å»º Git æ ‡ç­¾
- âŒ å‘å¸ƒåˆ° NPM
- âŒ åˆ›å»º Release

**å…¨è‡ªåŠ¨åŒ–**ï¼š
- âœ… æ™ºèƒ½ç‰ˆæœ¬æ£€æµ‹
- âœ… è‡ªåŠ¨æµ‹è¯•éªŒè¯
- âœ… è‡ªåŠ¨å‘å¸ƒæµç¨‹
- âœ… å®Œæ•´çš„å‘å¸ƒè®°å½•

ç°åœ¨ä½ å¯ä»¥ä¸“æ³¨äºä»£ç å¼€å‘ï¼Œè®© CI/CD å¤„ç†æ‰€æœ‰çš„å‘å¸ƒå·¥ä½œï¼ğŸš€